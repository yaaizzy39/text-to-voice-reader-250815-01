# Text to Voice Reader - Chrome拡張

ウェブサイトの選択したテキストをAIVIS音声で読み上げるChrome拡張機能です。

## 機能

- **テキスト選択読み上げ**: ウェブページ上のテキストを選択すると読み上げボタンが表示
- **AIVIS音声合成**: 高品質なAI音声でテキストを読み上げ
- **フォールバック機能**: AIVIS APIが利用できない場合はブラウザ標準音声で代替
- **設定カスタマイズ**: 音声速度、音量、品質を調整可能
- **右クリックメニュー**: コンテキストメニューからも読み上げ実行
- **音声キャッシュ**: 同じテキストは再生成せずキャッシュから再生

## インストール方法

1. **Chromeの開発者モードを有効化**
   - Chrome の設定 → 拡張機能 → 開発者モードをON

2. **拡張機能を読み込み**
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - このフォルダを選択

3. **APIキーを設定**
   - 拡張機能アイコンをクリックして設定画面を開く
   - [AIVIS API Keys](https://hub.aivis-project.com/cloud-api/api-keys) からAPIキーを取得
   - 取得したAPIキーを入力

## 使い方

### 基本的な使い方

1. **テキストを選択**: 読み上げたいテキストをマウスで選択
2. **読み上げボタンをクリック**: 選択範囲の近くに表示される「読み上げ」ボタンをクリック
3. **音声を聞く**: 高品質なAI音声でテキストが読み上げられます

### 右クリックメニューから

1. テキストを選択
2. 右クリック → 「選択したテキストを読み上げ」を選択

### 設定のカスタマイズ

- **音声モデル**: 好みの音声モデルを選択
- **再生速度**: 0.5倍〜2.0倍で調整
- **音量**: 0%〜100%で調整  
- **音質**: 低品質（高速）、標準品質、高品質から選択

## 対応サイト

- すべてのウェブサイト（`<all_urls>`対応）
- PDFファイル
- オンライン記事・ブログ
- 学習サイト・資料

## エラー処理とフォールバック

1. **AIVIS APIエラー**: ブラウザ標準のWeb Speech APIで代替
2. **ネットワークエラー**: 自動でフォールバック音声に切り替え
3. **APIキー無効**: エラーメッセージを表示し、設定画面への案内
4. **サーバーエラー**: 一時的にブラウザ標準音声を使用

## ファイル構成

```
text-to-voice-on-website-250815-01/
├── manifest.json           # Chrome拡張の設定ファイル
├── background.js           # バックグラウンドスクリプト（API通信）
├── content.js              # コンテンツスクリプト（テキスト選択・UI）
├── content.css             # コンテンツ用スタイル
├── popup.html              # 設定画面HTML
├── popup.css               # 設定画面スタイル
├── popup.js                # 設定画面ロジック
├── audio-player.html       # 音声再生ウィジェット
└── README.md               # このファイル
```

## トラブルシューティング

### 音声が再生されない
- APIキーが正しく設定されているか確認
- ブラウザで音声再生が許可されているか確認
- ネットワーク接続を確認

### 「APIキーが無効」エラー
- [AIVIS API Keys](https://hub.aivis-project.com/cloud-api/api-keys) で新しいキーを生成
- コピー時に余分なスペースが入っていないか確認

### 拡張機能が動作しない
- Chrome の拡張機能ページで有効になっているか確認
- ページを再読み込み
- 開発者ツールのコンソールでエラーを確認

## 技術仕様

- **Chrome拡張 Manifest V3** 対応
- **AIVIS Cloud API** を使用した高品質音声合成
- **Web Speech API** フォールバック対応
- **Chrome Storage API** での設定保存
- **レスポンシブデザイン** 対応

## 開発者向け情報

### 参照元コード
このChrome拡張は `example-talk-avatar-250725-02` フォルダのチャットアプリから以下の機能を移植・改良:

- AIVIS API通信ロジック（`script.js:762-794`）
- ストリーミング音声再生（`script.js:818-932`） 
- エラーハンドリングとフォールバック（`script.js:754-760`）
- 音声設定管理（`script.js:796-816`）

### 主な改良点
- Chrome拡張アーキテクチャに最適化
- Content Script でのテキスト選択UI
- Background Script でのAPI通信分離
- 包括的なエラーハンドリング
- ユーザーフレンドリーな設定画面

## ライセンス

このソフトウェアは防御的セキュリティ目的でのみ使用を許可します。

## バージョン履歴

- **v1.0.0** (2024-08-15): 初回リリース
  - テキスト選択読み上げ機能
  - AIVIS API統合
  - フォールバック機能
  - 設定画面